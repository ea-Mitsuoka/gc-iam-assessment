TODO:`internal-dev-tools`という名前のGC プロジェクトを作成する。


この問題を解決する、より安全で適切な方法は、**OAuth 2.0**を利用して、**スクリプトを実行するあなた自身のユーザーアカウントで認証する**ことです。

-----

### \#\# 1. 実装方針の変更 🗺️

  * **サービスアカウントキーの廃止:**
    `tools/credentials.json`ファイルは**使用しません**。代わりに、スクリプトを実行した開発者（あなた）が、Webブラウザ経由で「このスクリプトが自分の代理でスプレッドシートにアクセスすることを許可します」と一度だけ承認する方式に変更します。

  * **OAuth 2.0 クライアントIDの利用:**
    **自社（ベンダー）のGoogle Cloudプロジェクト**で「OAuth 2.0 クライアントID」という認証情報を発行します。スクリプトはこのIDを使い、あなたに対して認証を要求します。

  * **トークンの保存:**
    最初の認証が成功すると、`token.json`というファイルが`tools`ディレクトリに生成されます。2回目以降の実行では、このファイルが自動で使われるため、毎回ブラウザで認証する必要はありません。

-----

### \#\# 2. 具体的な実装手順 🛠️

#### **手順1: 自社（ベンダー）環境でのAPIと認証情報の設定（一度だけ実施）**

以下の作業は、**お客様のプロジェクトではなく、あなたの会社（ベンダー）が管理するGoogle Cloudプロジェクト**で行います。

1.  **APIの有効化:**
    自社のプロジェクトで、以下の2つのAPIを有効化します。

      * **Google Sheets API**
      * **Google Drive API**

2.  **OAuth同意画面の設定:**

      * Google Cloudコンソールの「APIとサービス」\>「**OAuth同意画面**」に移動します。
      * **User Type**で「**内部**」を選択し、「作成」をクリックします。（これにより、あなたの会社のドメイン内のユーザーのみが認証できるようになります）
      * アプリ名（例: `Terraform Spec Generator`）などを入力し、必須項目を埋めて保存します。

3.  **OAuth 2.0 クライアントIDの作成:**

      * 「APIとサービス」\>「**認証情報**」に移動します。
      * 「**+ 認証情報を作成**」\>「**OAuth 2.0 クライアントID**」を選択します。
      * アプリケーションの種類で「**デスクトップアプリ**」を選択します。
      * 名前を入力し、「作成」をクリックします。
      * 表示されたJSONを**ダウンロード**し、`tools/client_secrets.json`という名前で保存します。
      * **重要:** `.gitignore`ファイルに`tools/client_secrets.json`と`tools/token.json`を追加し、これらのファイルがコミットされないようにします。

#### **手順2: `generate_tfvars.py`スクリプトの修正** 🐍

-----

### \#\# 3. 新しいワークフロー 🔄

1.  **初回実行:**
    開発者（あなた）が初めて`python tools/generate_tfvars.py`を実行します。

      * 自動的にWebブラウザが起動し、Googleのログイン画面が表示されます。
      * あなたの会社のGoogleアカウントでログインし、「`Terraform Spec Generator`があなたのスプレッドシートにアクセスすることを許可しますか？」という画面で「許可」をクリックします。
      * `tools/token.json`ファイルが自動生成され、スクリプトが正常に実行されます。

2.  **2回目以降の実行:**
    `python tools/generate_tfvars.py`を実行します。

      * `token.json`が自動で読み込まれるため、ブラウザは起動せず、スクリプトがすぐに実行されます。

このアプローチにより、**お客様の環境に自社の認証情報を持ち込むことなく**、安全にスプレッドシートから`terraform.tfvars`を生成する仕組みが完成します。